<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mes.userinfo.mapper.SysUserRoleMapper">


    <select id="menuList" resultType="com.mes.menu.SysMenu">
        SELECT DISTINCT m.*
        FROM sys_menu m
        INNER JOIN sys_role_menu rm ON m.id = rm.menu_id
        INNER JOIN sys_user_role ur ON rm.role_id = ur.role_id
        INNER JOIN sys_user u ON ur.user_id = u.id
        WHERE u.id = #{userId}
        <if test="key != null and key != ''">
            and m.menu_name LIKE CONCAT('%', #{key}, '%')
        </if>
        order by m.list_sort
    </select>
</mapper>
